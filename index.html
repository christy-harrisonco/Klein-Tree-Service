<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Klein Tree Services | Paynesville, MN</title>
    <meta name="description" content="Professional tree removal and arborist care by Keith and Kevin Klein in Paynesville, MN." />
    
    <!-- Link to favicon. Logo component handles fallback if this is missing -->
    <link rel="icon" type="image/png" href="favicon.png">
    
    <!-- Tailwind CSS Runtime -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
      tailwind.config = {
        theme: {
          extend: {
            colors: {
              klein: { orange: '#f37021', dark: '#0f0c0b' },
              timber: { dark: '#0f0c0b', muted: '#1a1715', light: '#a3a3a3' }
            },
            fontFamily: {
              sans: ['Inter', 'sans-serif'],
              heading: ['Montserrat', 'sans-serif'],
              rugged: ['Oswald', 'sans-serif'],
              marker: ['Permanent Marker', 'cursive']
            }
          }
        }
      }
    </script>

    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;700;900&family=Montserrat:ital,wght@0,700;0,900;1,900&family=Oswald:wght@400;700&family=Permanent+Marker&display=swap" rel="stylesheet">
    
    <style>
      body { background-color: #0f0c0b; color: #fff; margin: 0; }
      .btn-premium { background-color: #f37021; transition: all 0.3s ease; text-transform: uppercase; font-weight: 900; letter-spacing: 0.1em; }
      .btn-premium:hover { background-color: #fff; color: #f37021; transform: translateY(-2px); box-shadow: 0 10px 20px -10px #f37021; }
      .bg-timber-grain { background-color: #1a1715; background-image: url("https://www.transparenttextures.com/patterns/wood-pattern.png"); }
      
      /* Loading Screen Logic */
      #root:empty::after { 
        content: "IGNITING THE SAWS..."; 
        position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); 
        font-family: 'Oswald', sans-serif; text-transform: uppercase; letter-spacing: 0.5em; opacity: 0.5;
        animation: pulse 2s infinite;
      }
      @keyframes pulse { 0%, 100% { opacity: 0.3; } 50% { opacity: 0.7; } }
      .glass { backdrop-filter: blur(12px); background: rgba(15, 12, 11, 0.85); border-bottom: 1px solid rgba(255,255,255,0.05); }
    </style>
<script type="importmap">
{
  "imports": {
    "@google/genai": "https://esm.sh/@google/genai@^1.35.0",
    "react": "https://esm.sh/react@^19.2.3",
    "lucide-react": "https://esm.sh/lucide-react@^0.562.0",
    "react/": "https://esm.sh/react@^19.2.3/",
    "vite": "https://esm.sh/vite@^7.3.1",
    "@vitejs/plugin-react": "https://esm.sh/@vitejs/plugin-react@^5.1.2"
  }
}
</script>
</head>
<body class="antialiased scroll-smooth">
    <div id="root"></div>

    <script type="module">
        // Direct browser-ready imports from ESM.sh
        import React, { useState, useEffect, useRef } from 'https://esm.sh/react@19.0.0?bundle';
        import { createRoot } from 'https://esm.sh/react-dom@19.0.0/client?bundle';
        import * as Lucide from 'https://esm.sh/lucide-react@0.475.0?bundle';
        import { GoogleGenAI } from 'https://esm.sh/@google/genai@1.34.0?bundle';

        // Helper to prevent "process is not defined" errors
        window.process = { env: { API_KEY: '' } };

        // --- COMPONENTS ---

        const Logo = ({ className = "h-12 w-12" }) => {
            const [hasError, setHasError] = useState(false);
            return (
                <div className={`relative overflow-hidden rounded-lg bg-zinc-900 border border-white/10 flex items-center justify-center transition-all ${className} ${hasError ? 'bg-klein-orange shadow-lg' : ''}`}>
                    {!hasError ? (
                        <img 
                            src="favicon.png" 
                            alt="K" 
                            className="w-full h-full object-contain p-1.5"
                            onError={() => setHasError(true)}
                        />
                    ) : (
                        <span className="text-white font-black text-2xl italic tracking-tighter">K</span>
                    )}
                </div>
            );
        };

        const App = () => {
            const [isScrolled, setIsScrolled] = useState(false);
            const [isMenuOpen, setIsMenuOpen] = useState(false);
            const [chatOpen, setChatOpen] = useState(false);
            const [messages, setMessages] = useState([{ role: 'model', text: "Foreman here. Keith's up a tree. How can I help?" }]);
            const [chatInput, setChatInput] = useState('');
            const [isTyping, setIsTyping] = useState(false);
            const chatEndRef = useRef(null);

            useEffect(() => {
                const handleScroll = () => setIsScrolled(window.scrollY > 50);
                window.addEventListener('scroll', handleScroll);
                return () => window.removeEventListener('scroll', handleScroll);
            }, []);

            useEffect(() => { chatEndRef.current?.scrollIntoView({ behavior: 'smooth' }); }, [messages]);

            const scrollTo = (id) => {
                const el = document.querySelector(id);
                if (el) el.scrollIntoView({ behavior: 'smooth' });
                setIsMenuOpen(false);
            };

            const handleChat = async (e) => {
                e.preventDefault();
                if (!chatInput.trim()) return;
                const userMsg = chatInput;
                setChatInput('');
                setMessages(prev => [...prev, { role: 'user', text: userMsg }]);
                setIsTyping(true);
                
                try {
                    const ai = new GoogleGenAI({ apiKey: window.process.env.API_KEY });
                    const response = await ai.models.generateContent({
                        model: 'gemini-3-flash-preview',
                        contents: [{ role: 'user', parts: [{ text: userMsg }] }],
                        config: { systemInstruction: "You are the Shop Foreman for Klein Tree Services (Paynesville, MN). Owners are Keith and Kevin Klein. Tone: Dry, professional arborist. Concise." }
                    });
                    setMessages(prev => [...prev, { role: 'model', text: response.text || "Call Keith: (320) 428-6726." }]);
                } catch (e) {
                    setMessages(prev => [...prev, { role: 'model', text: "Signal's spotty. Call the crew: (320) 428-6726." }]);
                } finally {
                    setIsTyping(false);
                }
            };

            return (
                <div className="min-h-screen bg-timber-dark selection:bg-klein-orange">
                    {/* Header */}
                    <header className={`fixed w-full z-50 transition-all duration-500 ${isScrolled ? 'glass py-3' : 'bg-transparent py-8'}`}>
                        <div className="max-w-7xl mx-auto px-4 flex justify-between items-center">
                            <div className="flex items-center space-x-4 cursor-pointer" onClick={() => scrollTo('#home')}>
                                <Logo className="h-14 w-14" />
                                <div className="flex flex-col">
                                    <span className="font-heading text-xl md:text-3xl font-black text-white uppercase italic leading-none">
                                        KLEIN TREE <span className="text-klein-orange">SERVICES</span>
                                    </span>
                                    <span className="text-[9px] font-bold uppercase tracking-[0.6em] text-white/40">PAYNESVILLE, MN</span>
                                </div>
                            </div>
                            <nav className="hidden lg:flex items-center space-x-8">
                                {['Home', 'Services', 'About', 'Contact'].map(item => (
                                    <button key={item} onClick={() => scrollTo(`#${item.toLowerCase()}`)} className="font-rugged text-sm uppercase tracking-widest font-bold hover:text-klein-orange transition-colors">{item}</button>
                                ))}
                                <a href="tel:320-428-6726" className="bg-klein-orange px-6 py-3 font-heading flex items-center space-x-3 hover:bg-white hover:text-klein-orange transition-all">
                                    <Lucide.Phone className="h-4 w-4" />
                                    <span>(320) 428-6726</span>
                                </a>
                            </nav>
                            <button className="lg:hidden text-white" onClick={() => setIsMenuOpen(!isMenuOpen)}>
                                {isMenuOpen ? <Lucide.X /> : <Lucide.Menu />}
                            </button>
                        </div>
                    </header>

                    {/* Mobile Menu */}
                    {isMenuOpen && (
                        <div className="fixed inset-0 z-[60] bg-timber-dark flex flex-col items-center justify-center space-y-8 p-6">
                             <button onClick={() => setIsMenuOpen(false)} className="absolute top-8 right-8"><Lucide.X className="h-10 w-10 text-white" /></button>
                             {['Home', 'Services', 'About', 'Contact'].map(item => (
                                <button key={item} onClick={() => scrollTo(`#${item.toLowerCase()}`)} className="text-5xl font-heading uppercase italic tracking-tighter">{item}</button>
                             ))}
                        </div>
                    )}

                    {/* Hero */}
                    <section id="home" className="relative min-h-screen flex items-center justify-center overflow-hidden">
                        <div className="absolute inset-0 z-0">
                            <img src="https://images.unsplash.com/photo-1518495973542-4542c06a5843?q=80&w=1920&auto=format&fit=crop" className="w-full h-full object-cover opacity-40" />
                            <div className="absolute inset-0 bg-gradient-to-t from-timber-dark via-transparent to-timber-dark/60"></div>
                        </div>
                        <div className="relative z-10 max-w-7xl mx-auto px-4 py-20 text-center lg:text-left">
                            <div className="inline-block px-4 py-2 bg-klein-orange/20 border-l-4 border-klein-orange mb-8 backdrop-blur-sm">
                                <span className="font-rugged text-sm uppercase tracking-[0.3em] font-bold italic">The Klein Brothers • Paynesville MN</span>
                            </div>
                            <h1 className="text-6xl md:text-9xl font-heading font-black leading-none mb-8 italic uppercase tracking-tighter">
                                PRECISION<br/><span className="text-klein-orange">POWER.</span>
                            </h1>
                            <p className="text-2xl md:text-4xl font-marker mb-12 max-w-3xl leading-relaxed drop-shadow-2xl">
                                We leave your yard cleaner than we found it. Keith's on the climb, Kevin's on the line.
                            </p>
                            <div className="flex flex-col sm:flex-row gap-6">
                                <button onClick={() => scrollTo('#contact')} className="btn-premium px-12 py-6 text-xl flex items-center justify-center space-x-3">
                                    <span>GET A QUOTE</span>
                                    <Lucide.ArrowRight />
                                </button>
                                <button onClick={() => scrollTo('#services')} className="px-12 py-6 border-2 border-white/20 hover:border-white transition-all font-bold tracking-widest bg-white/5">
                                    OUR WORK
                                </button>
                            </div>
                        </div>
                    </section>

                    {/* Services */}
                    <section id="services" className="py-32 bg-timber-muted relative">
                        <div className="max-w-7xl mx-auto px-4">
                             <div className="mb-20">
                                <h2 className="text-klein-orange font-rugged font-bold tracking-[0.5em] text-sm mb-4">CAPABILITIES</h2>
                                <h3 className="text-6xl md:text-8xl font-heading font-black italic uppercase italic">THE SERVICE <br/><span className="text-white/10 italic">MENU.</span></h3>
                             </div>
                             <div className="grid grid-cols-1 md:grid-cols-2 gap-12">
                                {[
                                    { title: 'Technical Removal', icon: Lucide.Axe, desc: 'Surgical removals in tight quarters near power lines and homes.' },
                                    { title: 'Canopy Maintenance', icon: Lucide.Scissors, desc: 'Health-focused pruning to prevent storm damage and save your oaks.' },
                                    { title: 'Stump Grinding', icon: Lucide.Tractor, desc: 'Deep-set grinding to clear land for new grass or structure footings.' },
                                    { title: 'Storm Response', icon: Lucide.ShieldAlert, desc: '24/7 emergency cleanup for central Minnesota and lake areas.' }
                                ].map(s => (
                                    <div key={s.title} className="bg-timber-dark border border-white/5 p-10 shadow-2xl hover:border-klein-orange transition-all group">
                                        <div className="bg-klein-orange p-4 w-fit mb-6 transition-transform group-hover:scale-110"><s.icon /></div>
                                        <h4 className="text-3xl font-heading uppercase font-black italic mb-4">{s.title}</h4>
                                        <p className="text-timber-light leading-relaxed">{s.desc}</p>
                                    </div>
                                ))}
                             </div>
                        </div>
                    </section>

                    {/* About */}
                    <section id="about" className="py-32 bg-timber-dark relative overflow-hidden">
                        <div className="max-w-7xl mx-auto px-4 grid lg:grid-cols-2 gap-20 items-center">
                            <div className="relative">
                                <img src="https://images.unsplash.com/photo-1542332213-9b5a5a3fad35?auto=format&fit=crop&q=80&w=1200" className="w-full h-[600px] object-cover grayscale brightness-50" />
                                <div className="absolute bottom-10 -right-10 bg-white p-8 shadow-2xl max-w-sm hidden md:block">
                                    <p className="font-marker text-timber-dark text-2xl italic leading-tight">"One family, zero shortcuts. We treat your yard like our own."</p>
                                </div>
                            </div>
                            <div>
                                <h2 className="text-klein-orange font-rugged font-bold tracking-[0.5em] text-sm mb-4 uppercase">OUR LEGACY</h2>
                                <h3 className="text-6xl md:text-8xl font-heading font-black italic uppercase italic mb-8">THE KLEIN <br/> BROTHERS.</h3>
                                <p className="text-xl text-timber-light leading-relaxed mb-8">
                                    Keith handles the technical precision work in the canopy—climbing and cutting that requires absolute focus. Kevin works alongside him on the ground, keeping the operation running smooth and ensuring the site stays safe.
                                </p>
                                <div className="grid grid-cols-2 gap-8">
                                    <div className="border-l-4 border-klein-orange pl-4">
                                        <span className="block font-heading text-3xl italic uppercase">100%</span>
                                        <span className="text-[10px] uppercase tracking-widest font-bold text-white/40">Fully Insured</span>
                                    </div>
                                    <div className="border-l-4 border-white pl-4">
                                        <span className="block font-heading text-3xl italic uppercase">LOCAL</span>
                                        <span className="text-[10px] uppercase tracking-widest font-bold text-white/40">Paynesville Proud</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </section>

                    {/* Contact */}
                    <section id="contact" className="py-32 bg-timber-muted">
                        <div className="max-w-7xl mx-auto px-4 grid lg:grid-cols-2 gap-20">
                            <div>
                                <h2 className="text-klein-orange font-rugged font-bold tracking-[0.5em] text-sm mb-4 uppercase">CONNECT</h2>
                                <h3 className="text-6xl md:text-8xl font-heading font-black italic uppercase italic mb-12">FREE <br/> QUOTES.</h3>
                                <div className="space-y-12">
                                    <div className="border-l-4 border-klein-orange pl-8">
                                        <p className="font-marker text-white/40 text-xl mb-2 italic">"Direct Dispatch"</p>
                                        <a href="tel:320-428-6726" className="text-4xl md:text-6xl font-heading text-white hover:text-klein-orange transition-colors tracking-tight">(320) 428-6726</a>
                                    </div>
                                </div>
                            </div>
                            <div className="bg-white p-10 md:p-16 text-timber-dark shadow-2xl">
                                <form action="https://formspree.io/f/mwvpgjpe" method="POST" className="space-y-10">
                                    <input type="text" name="name" required className="w-full border-b-2 border-zinc-100 py-4 font-heading text-xl outline-none focus:border-klein-orange transition-all" placeholder="YOUR NAME" />
                                    <input type="tel" name="phone" required className="w-full border-b-2 border-zinc-100 py-4 font-heading text-xl outline-none focus:border-klein-orange transition-all" placeholder="PHONE NUMBER" />
                                    <button type="submit" className="w-full bg-timber-dark text-white py-6 font-heading text-2xl uppercase italic tracking-widest hover:bg-klein-orange transition-all">SEND REQUEST</button>
                                </form>
                            </div>
                        </div>
                    </section>

                    {/* AI Chat */}
                    <div className="fixed bottom-8 right-8 z-[70]">
                        {chatOpen && (
                            <div className="absolute bottom-20 right-0 w-80 sm:w-96 h-[500px] bg-timber-dark border-4 border-zinc-800 shadow-2xl flex flex-col animate-in slide-in-from-bottom-5">
                                <div className="bg-white p-4 flex justify-between items-center text-timber-dark border-b-4 border-klein-orange">
                                    <div className="flex items-center space-x-3 italic">
                                        <Lucide.Coffee className="text-klein-orange" />
                                        <span className="font-heading text-2xl uppercase">FOREMAN</span>
                                    </div>
                                    <button onClick={() => setChatOpen(false)}><Lucide.X /></button>
                                </div>
                                <div className="flex-1 overflow-y-auto p-6 bg-timber-grain space-y-4">
                                    {messages.map((m, i) => (
                                        <div key={i} className={`flex ${m.role === 'user' ? 'justify-end' : 'justify-start'}`}>
                                            <div className={`p-4 font-rugged font-bold text-sm max-w-[85%] ${m.role === 'user' ? 'bg-klein-orange italic' : 'bg-white text-zinc-900 border-l-4 border-klein-orange'}`}>
                                                {m.text}
                                            </div>
                                        </div>
                                    ))}
                                    {isTyping && <div className="text-white/30 font-heading text-xs tracking-widest italic animate-pulse uppercase">CALCULATING...</div>}
                                    <div ref={chatEndRef} />
                                </div>
                                <form onSubmit={handleChat} className="p-4 bg-white flex space-x-2">
                                    <input value={chatInput} onChange={e => setChatInput(e.target.value)} placeholder="ENTER INTEL..." className="flex-1 bg-zinc-100 px-4 font-rugged text-xs uppercase text-zinc-900 outline-none" />
                                    <button className="bg-zinc-900 text-white p-3 hover:bg-klein-orange transition-colors"><Lucide.Send /></button>
                                </form>
                            </div>
                        )}
                        <button onClick={() => setChatOpen(!chatOpen)} className="bg-timber-dark border-4 border-zinc-800 p-5 shadow-2xl hover:border-klein-orange transition-all">
                            <Lucide.MessageSquare className="h-8 w-8 text-white" />
                        </button>
                    </div>
                </div>
            );
        };

        const rootElement = document.getElementById('root');
        createRoot(rootElement).render(React.createElement(App));
    </script>
</body>
</html>